{
{% if 'elasticMasterNode' in group_names %}
  "server": true,
  "bootstrap_expect": 3,
  "retry_join": [
    {%- for item in groups['elasticMasterNode'] if item != ansible_nodename -%}
      "{{ hostvars[item]['ansible_host'] | default(item) }}"{%- if loop.nextitem is defined -%},{%- endif -%}
    {%- endfor -%}
  ],
{% else %}
  "server": false,
  "retry_join": [
    {%- for item in groups['elasticMasterNode'] -%}
      "{{ hostvars[item]['ansible_host'] | default(item) }}"{%- if loop.nextitem is defined -%},{%- endif -%}
    {%- endfor -%}
  ],
{% endif %}
{# ---------------- #}
  "datacenter": "{{ consul_dc_name }}",
  "data_dir": "/var/consul",
  "encrypt": "{{ consul_key }}",
  "log_level": "WARN",
  "enable_syslog": true,
  "enable_script_checks": true,
  "addresses": {
    "dns": "0.0.0.0"
  }
}
